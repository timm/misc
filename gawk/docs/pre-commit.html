<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>pre-commit.sample</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>pre-commit.sample</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>An example hook script to verify what is about to be committed.
Called by &ldquo;git commit&rdquo; with no arguments.  The hook should
exit with non-zero status after issuing an appropriate message if
it wants to stop the commit.</p>
<p>To enable this hook, rename this file to &ldquo;pre-commit&rdquo;.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span>git<span class="w"> </span>rev-parse<span class="w"> </span>--verify<span class="w"> </span>HEAD<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="k">then</span>
<span class="w">	</span><span class="nv">against</span><span class="o">=</span>HEAD
<span class="k">else</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>Initial commit: diff against an empty tree object</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="w">	</span><span class="nv">against</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>hash-object<span class="w"> </span>-t<span class="w"> </span>tree<span class="w"> </span>/dev/null<span class="k">)</span>
<span class="k">fi</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>If you want to allow non-ASCII filenames set this variable to true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nv">allownonascii</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>config<span class="w"> </span>--type<span class="o">=</span>bool<span class="w"> </span>hooks.allownonascii<span class="k">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Redirect output to stderr.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nb">exec</span><span class="w"> </span><span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Cross platform projects tend to avoid non-ASCII filenames; prevent
them from being added to the repository. We exploit the fact that the
printable range starts at the space character and ends with tilde.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$allownonascii</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Note that the use of brackets around a tr range is ok here, (it&rsquo;s
even required, for portability to Solaris 10&rsquo;s /usr/bin/tr), since
the square bracket bytes happen to fall in the designated range.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="w">	</span><span class="nb">test</span><span class="w"> </span><span class="k">$(</span>git<span class="w"> </span>diff<span class="w"> </span>--cached<span class="w"> </span>--name-only<span class="w"> </span>--diff-filter<span class="o">=</span>A<span class="w"> </span>-z<span class="w"> </span><span class="nv">$against</span><span class="w"> </span><span class="p">|</span>
<span class="w">	  </span><span class="nv">LC_ALL</span><span class="o">=</span>C<span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;[ -~]\0&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-c<span class="k">)</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="k">then</span>
<span class="w">	</span>cat<span class="w"> </span><span class="s">&lt;&lt;\EOF</span>
<span class="s">Error: Attempt to add a non-ASCII file name.</span>

<span class="s">This can cause problems if you want to work with people on other platforms.</span>

<span class="s">To be portable it is advisable to rename the file.</span>

<span class="s">If you know what you are doing you can disable this check using:</span>

<span class="s">  git config hooks.allownonascii true</span>
<span class="s">EOF</span>
<span class="w">	</span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="k">fi</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>If there are whitespace errors, print the offending file names and fail.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nb">exec</span><span class="w"> </span>git<span class="w"> </span>diff-index<span class="w"> </span>--check<span class="w"> </span>--cached<span class="w"> </span><span class="nv">$against</span><span class="w"> </span>--

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
